<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciamento de Leads</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Variáveis de cores */
        :root {
            --background-color: linear-gradient(135deg, #ffffff, #e0e0e0);
            --text-color: #333;
            --header-background: rgba(255, 255, 255, 0.9);
            --header-text-color: #333;
            --sidebar-background: linear-gradient(135deg, #4e4376, #6a5acd);
            --sidebar-text-color: #fff;
            --card-background: rgba(255, 255, 255, 0.9);
            --card-text-color: #333;
            --button-background: #381e97;
            --button-hover-background: #6a5acd;
            --button-text-color: white;
        }
    
        body.dark-mode {
            --background-color: linear-gradient(135deg, #0a0f1e, #0d1b2a);
            --text-color: #e0e0e0;
            --header-background: rgba(27, 38, 59, 0.8);
            --header-text-color: #e0e0e0;
            --sidebar-background: linear-gradient(135deg, #1b263b, #0d1b2a);
            --sidebar-text-color: #e0e0e0;
            --card-background: rgba(27, 38, 59, 0.8);
            --card-text-color: #e0e0e0;
            --button-background: #381e97;
            --button-hover-background: #6a5acd;
            --button-text-color: white;
        }
    
        body {
    font-family: Arial, sans-serif;
    margin: 0;
    display: block; /* Altere de flex para block para permitir rolagem */
    height: auto; /* Permite que o conteúdo determine a altura */
    overflow-y: auto; /* Habilita a rolagem vertical */
    background: var(--background-color);
    color: var(--text-color);
    transition: background-color 0.3s, color 0.3s;
}
    
        .theme-toggle-button {
            position: fixed;
            top: 10px;
            right: 10px;
            background-color: #6a5acd;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
            z-index: 1001; /* Ensure the button is above other elements */
        }
    
        .theme-toggle-button:hover {
            background-color: #4e4376;
            transform: scale(1.1);
        }
    
        .sidebar {
            width: 60px;
            background: var(--sidebar-background);
            color: var(--sidebar-text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            box-sizing: border-box;
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            transition: width 0.3s ease, background 0.3s;
            z-index: 1000;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }
    
        .sidebar:hover {
            width: 200px;
        }
    
        .sidebar a {
            color: var(--sidebar-text-color);
            text-decoration: none;
            margin: 10px 0;
            width: 100%;
            text-align: center;
            padding: 10px;
            border-radius: 5px;
            transition: background-color 0.3s, width 0.3s;
            white-space: nowrap;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    
        .sidebar a i {
            margin-right: 10px;
            font-size: 1.2em;
        }
    
        .sidebar a span {
            display: none;
            transition: display 0.3s;
        }
    
        .sidebar:hover a span {
            display: inline;
        }
    
        .main-content {
    flex-grow: 1;
    padding: 20px;
    box-sizing: border-box;
    display: block; /* Altere de flex para block */
    align-items: flex-start; /* Alinha o conteúdo ao topo */
    overflow-y: visible; /* Permite que o conteúdo ultrapasse o contêiner */
    background: var(--background-color);
    color: var(--text-color);
    margin-left: 80px; /* Espaçamento da aba lateral */
    transition: margin-left 0.3s ease, background 0.3s;
}
        
    
        .sidebar:hover ~ .main-content {
            margin-left: 220px;
        }
    
        .sidebar:hover ~ .header {
            width: calc(100% - 220px);
        }
    
        .header {
    display: flex;
    justify-content: center; /* Centraliza horizontalmente */
    align-items: center; /* Centraliza verticalmente */
    background: var(--header-background);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
    width: calc(100% - 80px); /* Espaçamento da aba lateral */
    transition: background-color 0.3s, color 0.3s;
    margin-bottom: 20px; /* Espaçamento entre o cabeçalho e o funil */
    position: relative; /* Necessário para posicionar os pseudo-elementos */
}

.header h1 {
    font-family: 'Merriweather', serif; /* Mantém a fonte Merriweather */
    font-size: 3em; /* Ajuste o tamanho conforme necessário */
    font-weight: 700; /* Negrito */
    color: var(--header-text-color); /* Mantém a cor existente */
    text-align: center; /* Centraliza o texto */
    letter-spacing: 1px; /* Adiciona espaçamento entre as letras */
    margin: 0; /* Remove margens extras */
    position: relative; /* Necessário para os pseudo-elementos */
}

.header h1::before,
.header h1::after {
    content: ''; /* Adiciona conteúdo vazio para as linhas */
    position: absolute;
    top: 50%; /* Centraliza verticalmente em relação ao texto */
    width: 50px; /* Comprimento da linha, ajuste conforme necessário */
    height: 2px; /* Espessura da linha */
    background-color: var(--header-text-color); /* Cor da linha */
    transform: translateY(-50%); /* Ajusta para alinhar perfeitamente ao centro */
}

.header h1::before {
    left: -70px; /* Ajuste a distância da linha à esquerda do texto */
}

.header h1::after {
    right: -70px; /* Ajuste a distância da linha à direita do texto */
}
    
        .user-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
    
        .user-info i {
            font-size: 2em;
            color: #6a5acd;
        }
    
        .user-info span {
            margin-top: 5px;
            font-size: 1em;
            color: var(--header-text-color);
        }
    
        .form-container {
            background: var(--card-background);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            transition: background-color 0.3s, color 0.3s;
            width: calc(100% - 80px); /* Espaçamento da aba lateral */
            max-width: none;
        }
    
        .sidebar:hover ~ .form-container {
            width: calc(100% - 220px);
        }
    
        .form-container h2 {
            margin-top: 0;
        }
    
        .form-container form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
    
        .form-container form input,
        .form-container form button {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
        }
    
        .form-container form button {
            background: var(--button-background);
            color: var(--button-text-color);
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
    
        .form-container form button:hover {
            background-color: var(--button-hover-background);
        }
    
        .filters {
            background: var(--card-background);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            transition: background-color 0.3s, color 0.3s;
            width: calc(100% - 80px); /* Espaçamento da aba lateral */
            max-width: none;
        }
    
        .sidebar:hover ~ .filters {
            width: calc(100% - 220px);
        }
    
        .filters label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
    
        .filters input[type="text"] {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
            width: 100%;
        }
    
.funnels {
    display: flex;
    flex-direction: column;
    gap: 20px;
    padding: 20px 0;
    width: 100%;
    height: calc(100vh - 120px); /* Altura total da tela menos o cabeçalho e outros elementos */
    overflow-y: hidden; /* Impede rolagem vertical no contêiner principal */
}   
.funnel-stage {
    flex-grow: 1;
    min-width: 300px; /* Largura mínima para os estágios */
    background: var(--card-background);
    padding: 10px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: background-color 0.3s, color 0.3s;
    height: 100%; /* Ajusta a altura para ocupar o espaço disponível */
}
        
.dropzone {
    flex-grow: 1;
    width: 100%;
    height: calc(100% - 40px); /* Ajusta a altura para ocupar o espaço restante, considerando o título */
    border: 2px dashed #ccc;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    overflow-y: auto; /* Permite rolagem vertical dentro do funil */
    transition: background-color 0.3s;
}
        
        .funnel-titles {
            display: flex;
            gap: 20px;
            flex-wrap: nowrap; /* Manter os estágios em uma única linha */
            position: sticky;
            top: 0;
            background: var(--background-color);
            z-index: 1000;
            transition: background-color 0.3s, color 0.3s;
        }
        
.funnel-leads {
    display: flex;
    gap: 20px;
    flex-wrap: nowrap; /* Manter os estágios em uma única linha */
    height: 100%; /* Garante que os funis ocupem toda a altura disponível */
}
        
        .funnel-titles .funnel-stage {
            padding-top: 10px; /* Espaço para o cabeçalho fixo */
        }
        
        .funnel-titles h2 {
            background: var(--button-background);
            color: var(--button-text-color);
            padding: 10px;
            margin: 0;
            text-align: center;
            font-weight: bold;
            border-bottom: 1px solid #ccc;
            width: 100%;
            pointer-events: none; /* Impedir que os títulos sejam arrastáveis */
        }
    
        .lead-card {
            background: var(--card-background);
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            cursor: grab;
            display: flex;
            flex-direction: column;
            gap: 10px;
            min-width: 250px; /* Largura mínima para os cards */
            transition: background-color 0.3s, color 0.3s;
        }
    
        .lead-card:hover {
            background-color: #f0f0f0;
        }
    
        .lead-card p {
            margin: 0;
            font-size: 0.9em;
            color: var(--text-color);
        }
    
        .lead-card .lead-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    
        .lead-card .lead-header h3 {
            margin: 0;
            font-size: 1.1em;
            color: var(--text-color);
        }
    
        .lead-card .lead-header .lead-score {
            background: var(--button-background);
            color: var(--button-text-color);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9em;
        }
    
        .lead-card .lead-details {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
    
        .lead-card .lead-details p {
            display: flex;
            justify-content: space-between;
        }
    
        .lead-card .lead-details p span {
            font-weight: bold;
        }

    
        .dropzone.dragover {
            background-color: #e0e0e0;
        }
    
        .lead-card.red {
            background-color: #ffcccc;
        }
    
        .header-buttons {
            display: flex;
            align-items: center;
            gap: 20px; /* Espaçamento entre o botão e os filtros */
        }
        
        .toggle-button {
            background: var(--button-background);
            color: var(--button-text-color);
            border: none;
            padding: 10px 10px; /* Aumenta o tamanho do botão */
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em; /* Ajusta o tamanho da fonte */
            font-weight: bold; /* Deixa o texto em negrito */
            transition: background-color 0.3s;
            margin-top: 9%;
        }
        
        .toggle-button:hover {
            background-color: var(--button-hover-background);
        }
        
        .search-container {
            display: flex;
            align-items: center;
            background: var(--card-background);
            padding: 5px 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-left: 20px;
            flex-grow: 1;
            max-width: 300px; /* Ajuste o tamanho máximo conforme necessário */
        }
        
        .search-container input {
            border: none;
            outline: none;
            padding: 5px;
            font-size: 1em;
            background: transparent;
            color: var(--text-color);
            flex-grow: 1;
        }
        
        .search-container .search-icon {
            margin-left: 10px;
            color: var(--text-color);
        }
        .filters-container {
            display: flex;
            flex-direction: column; /* Posiciona os filtros em coluna */
            gap: 10px; /* Espaçamento entre os filtros */
            width: 100%; /* Garante que os filtros ocupem toda a largura disponível */
            max-width: 300px; /* Define um tamanho máximo para os filtros */
            margin-left: 0; /* Remove margens desnecessárias */
            padding: 0; /* Remove preenchimentos extras */
            box-sizing: border-box; /* Garante que largura e altura incluam bordas e preenchimentos */
        }
        
        .search-container {
            display: flex;
            align-items: center;
            background: var(--card-background);
            padding: 5px 10px; /* Ajuste o preenchimento para evitar que o filtro fique maior */
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 100%; /* Garante que cada filtro ocupe toda a largura do contêiner */
            box-sizing: border-box; /* Inclui bordas e preenchimentos no cálculo da largura */
        }
        .modal {
            display: none; /* Oculto por padrão */
            position: fixed;
            z-index: 1000;
            left: 50%; /* Centraliza horizontalmente */
            top: 50%; /* Centraliza verticalmente */
            transform: translate(-50%, -50%); /* Ajusta para que o modal fique exatamente no centro */
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Fundo escuro com transparência */
            overflow: hidden; /* Garante que o conteúdo do modal não ultrapasse a tela */
        }
        
        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            width: 80%; /* Largura do modal */
            max-width: 1200px; /* Largura máxima */
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            box-sizing: border-box; /* Inclui padding e bordas no cálculo da largura */
            position: absolute; /* Garante que o modal-content seja posicionado dentro do modal */
            top: 50%; /* Centraliza verticalmente */
            left: 50%; /* Centraliza horizontalmente */
            transform: translate(-50%, -50%); /* Ajusta para que o modal-content fique exatamente no centro */
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: 20px;
            position: relative; /* Para posicionar o botão "X" */
        }
        
        .modal-header h2 {
            font-size: 1.8em;
            margin: 0;
            color: #381e97;
        }
        
        .modal-header p {
            font-size: 1em;
            margin: 5px 0;
            color: #333;
        }
        
        .close-button {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px; /* Aumentado para maior visibilidade */
            height: 50px; /* Aumentado para maior visibilidade */
            font-size: 1.8em; /* Aumentado para maior visibilidade */
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s, transform 0.3s;
        }
        
        .close-button:hover {
            background-color: #ff1a1a;
            transform: scale(1.1);
        }
        
        .modal-details {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .modal-details label {
            font-size: 1em;
            color: #333;
            margin-bottom: 5px;
        }
        
        .modal-details input {
            padding: 10px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
            color: #333;
            width: 100%;
            box-sizing: border-box;
        }
        .modal-details select {
            padding: 10px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
            color: #333;
            width: 100%;
            box-sizing: border-box;
            appearance: none; /* Remove o estilo padrão do navegador */
            background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 5"><path fill="%23333" d="M2 0L0 2h4zM2 5L0 3h4z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 10px;
            cursor: pointer;
        }
        
        .modal-details select:focus {
            outline: none;
            border-color: #381e97;
            box-shadow: 0 0 5px rgba(13, 60, 110, 0.5);
        }
        
        #updateLeadStageButton {
            margin-top: 10px;
            padding: 10px;
            background-color: #0d3c6e;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s, transform 0.3s;
        }
        
        #updateLeadStageButton:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }
                .modal-body {
                    display: flex;
                    gap: 20px; /* Espaçamento entre os cards */
                    justify-content: space-between; /* Espaçamento uniforme */
                    flex-wrap: nowrap; /* Impede que os cards fiquem empilhados */
                }
                
                .card {
                    background-color: #f9f9f9;
                    padding: 20px;
                    border-radius: 10px;
                    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
                    flex: 1; /* Faz com que os cards ocupem o mesmo espaço */
                    display: flex;
                    flex-direction: column;
                    gap: 10px;
                    min-width: 300px; /* Define uma largura mínima para os cards */
                    max-width: 50%; /* Limita a largura máxima de cada card */
                }
                
                .card h3 {
                    margin-top: 0;
                    font-size: 1.5em;
                    color: #381e97;
                }
                
                .card button {
                    margin-top: 10px;
                    padding: 10px;
                    background-color: #381e97;
                    color: white;
                    border: none;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 1em;
                    transition: background-color 0.3s, transform 0.3s;
                }
                
                .card button:hover {
                    background-color: #381e97;
                    transform: scale(1.05);
                }
                
                .tarefas-list {
                    margin-top: 20px;
                    max-height: 200px;
                    overflow-y: auto;
                    border-top: 1px solid #ccc;
                    padding-top: 10px;
                }
                
                .tarefas-list .note {
                    background-color: #fff;
                    padding: 10px;
                    border-radius: 5px;
                    box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
                    margin-bottom: 10px;
                }

                input[type="text"],
                input[type="email"],
                input[type="date"],
                input[type="time"],
                select {
                    padding: 10px;
                    font-size: 1em;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    background-color: #f9f9f9;
                    color: #333;
                    width: 100%;
                    box-sizing: border-box;
                    transition: border-color 0.3s, box-shadow 0.3s;
                }
                
                input[type="text"]:focus,
                input[type="email"]:focus,
                input[type="date"]:focus,
                input[type="time"]:focus,
                select:focus {
                    outline: none;
                    border-color: #0d3c6e;
                    box-shadow: 0 0 5px rgba(13, 60, 110, 0.5);
                }
                
                button {
                    padding: 10px;
                    background-color: #381e97;
                    color: white;
                    border: none;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 1em;
                    transition: background-color 0.3s, transform 0.3s;
                }
                
                button:hover {
                    background-color: #6a5acd;
                    transform: scale(1.05);
                }

                #saveLeadChangesButton {
                    margin-top: 20px;
                    padding: 10px;
                    background-color: #381e97;
                    color: white;
                    border: none;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 1em;
                    transition: background-color 0.3s, transform 0.3s;
                }
                
                #saveLeadChangesButton:hover {
                    background-color: #6a5acd;
                    transform: scale(1.05);
                }
                .anotacoes-list {
                    margin-top: 20px;
                    max-height: 200px;
                    overflow-y: auto;
                    border-top: 1px solid #ccc;
                    padding-top: 10px;
                }
                
                .anotacoes-list .note {
                    background-color: #fff;
                    padding: 10px;
                    border-radius: 5px;
                    box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
                    margin-bottom: 10px;
                }
                
                textarea {
                    width: 100%;
                    padding: 10px;
                    font-size: 1em;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    background-color: #f9f9f9;
                    color: #333;
                    box-sizing: border-box;
                    resize: none; /* Impede o redimensionamento */
                }
                
                textarea:focus {
                    outline: none;
                    border-color: #6a5acd;
                    box-shadow: 0 0 5px rgba(13, 60, 110, 0.5);
                }
                .sidebar-bottom-buttons {
  display: flex;
  justify-content: space-between;
  width: 100%;
  padding: 10px;
  box-sizing: border-box;
  margin-top: auto; /* Garante que os botões fiquem no rodapé */
}

.sidebar-button {
  flex: 1;
  text-align: center;
  padding: 10px;
  border-radius: 5px;
  transition: background-color 0.3s;
}

.sidebar-button i {
  margin-right: -5px; /* Reduz o espaçamento entre o ícone e o texto */
}

.sidebar-button span {
  margin-left: -5px; /* Reduz o espaçamento entre o texto e o ícone */
}

.sidebar-button:first-child {
  margin-right: 5px;
}

.sidebar-button:last-child {
  margin-left: 5px;
}
.step.no-hover:hover {
background: var(--card-background);
transform: none;
}
.step.active {
background: var(--button-background);
color: var(--button-text-color);
margin-left: 50px;
}
.step.no-hover:hover {
background: var(--card-background);
transform: none;
}
.step.disabled {
pointer-events: none;
opacity: 1;
}
.menu-item {
position: relative;
}



.sidebar:not(:hover) .subcategory-sidebar {
display: none !important; /* Garante que o submenu seja ocultado */
}
#homeChevron {
transition: transform 0.3s ease;
}
.sidebar a#homeLink {
display: flex;
align-items: center;
justify-content: flex-start; /* Alinha o conteúdo à esquerda */
padding: 15px 20px; /* Aumenta o espaço interno */
width: 100%; /* Garante que o botão ocupe toda a largura disponível */
box-sizing: border-box; /* Inclui o padding na largura total */
overflow: hidden; /* Evita que o conteúdo transborde */
gap: 1px; /* Adiciona espaço entre o ícone e o texto */
}
.sidebar:not(:hover) #homeChevron {
display: none; /* Esconde o ícone quando a sidebar está colapsada */
}

/* Mantém o submenu visível enquanto o mouse está sobre o item principal ou o submenu */
.menu-item:hover .subcategory-sidebar,
.subcategory-sidebar:hover {
display: none;
}
.subcategory-sidebar {
display: none; /* Esconde o submenu por padrão */
position: absolute; /* Posiciona em relação ao botão pai */
top: 0; /* Alinha ao topo do botão pai */
left: 100%; /* Posiciona ao lado direito do botão pai */
background: var(--sidebar-background);
color: var(--sidebar-text-color);
padding: 10px;
flex-direction: column;
gap: 10px;
width: 250px;
box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
z-index: 1000;
transition: all 0.3s ease;
}
#relatoriosSubcategoriesSidebar {
    display: none; /* Esconde o submenu por padrão */
    position: absolute; /* Posiciona em relação ao elemento pai */
    top: 29%; /* Alinha ao topo do item pai */
    left: 100%; /* Ajusta para a largura da sidebar expandida */
    background: var(--sidebar-background);
    color: var(--sidebar-text-color);
    padding: 10px;
    flex-direction: column;
    gap: 10px;
    width: 250px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    z-index: 10001; /* Garante que o submenu fique acima de todos os outros elementos */
    transition: all 0.3s ease;
}
#homeSubcategoriesSidebar {
top: 10%; /* Ajuste a posição vertical conforme necessário */
left: 116%; /* Ajuste a posição horizontal conforme necessário */
position: absolute; /* Garante que a posição seja relativa ao elemento pai */
z-index: 1001; /* Certifique-se de que está acima de outros elementos */
}
#comercialSubcategoriesSidebar {
display: none; /* Esconde o submenu por padrão */
position: absolute; /* Posiciona em relação ao botão pai */
top: 0; /* Alinha ao topo do botão pai */
left: 100%; /* Posiciona ao lado direito do botão pai */
background: var(--sidebar-background);
color: var(--sidebar-text-color);
padding: 10px;
flex-direction: column;
gap: 10px;
width: 250px;
box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
z-index: 1000;
transition: all 0.3s ease;

/* Centraliza os itens */
display: flex;
align-items: center; /* Alinha horizontalmente ao centro */
justify-content: center; /* Alinha verticalmente ao centro */
}
.action-container {
    display: flex;
    align-items: flex-start; /* Alinha os itens ao topo */
    gap: 20px; /* Espaçamento entre o botão e os campos de busca */
    margin-left: 60%;
}

.filters-container {
    display: flex;
    flex-direction: column; /* Coloca os campos de busca um em cima do outro */
    gap: 10px; /* Espaçamento entre os campos de busca */
    width: 300px; /* Define uma largura fixa para os campos de busca */
}

.search-container {
    display: flex;
    align-items: center;
    background: var(--card-background);
    padding: 5px 10px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    box-sizing: border-box;
}

.search-container input {
    border: none;
    outline: none;
    padding: 5px;
    font-size: 1em;
    background: transparent;
    color: var(--text-color);
    flex-grow: 1;
}

.search-container .search-icon {
    margin-left: 10px;
    color: var(--text-color);
}
.form-container-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5); /* Fundo escuro com transparência */
    backdrop-filter: blur(5px); /* Efeito de desfoque no fundo */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000; /* Garante que o modal fique acima de tudo */
}

.form-container {
    background: var(--card-background);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
    width: 400px; /* Define a largura do modal */
    max-width: 90%; /* Garante que o modal seja responsivo */
    animation: fadeIn 0.3s ease; /* Animação de entrada */
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: scale(0.9);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

.form-container h2 {
    margin-top: 0;
    text-align: center;
}

.form-container form input,
.form-container form select,
.form-container form button {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 1em;
}

.form-container form button {
    background: var(--button-background);
    color: var(--button-text-color);
    border: none;
    cursor: pointer;
    transition: background-color 0.3s;
}

.form-container form button:hover {
    background-color: var(--button-hover-background);
}
.close-button {
    position: absolute;
    top: 10px; /* Ajuste a distância do topo */
    right: 10px; /* Ajuste a distância da direita */
    background-color: #ff4d4d;
    color: white;
    border: none;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    font-size: 1.5em;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    transition: background-color 0.3s, transform 0.3s;
}

.close-button:hover {
    background-color: #ff1a1a;
    transform: scale(1.1);
}
    </style>
</head>
<body>
    <div class="sidebar" id="sidebar">
    <div class="menu-item">
            <a href="#" id="homeLink" onclick="toggleSubmenu('homeSubcategoriesSidebar')">
                <i class="fas fa-home"></i><span>Home</span>
                <i class="fas fa-chevron-down" id="homeChevron" style="margin-left: 5px; transition: transform 0.3s;"></i>
            </a>
            <div id="homeSubcategoriesSidebar" class="subcategory-sidebar">
                <a href="dashboard.html" class="subcategory"><i class="fas fa-chart-line"></i><span>Dashboard Comercial</span></a>
                <a href="dashboard_gestor_comercial.html" class="subcategory"><i class="fas fa-chart-bar"></i><span>Dashboard Gestor Comercial</span></a>
                <a href="dashboard_administrativo.html" class="subcategory"><i class="fas fa-chart-pie"></i><span>Dashboard Administrativo</span></a>
            </div>
        </div>
    <a href="cadastro_cliente.html"><i class="fas fa-user-plus"></i><span>Cadastrar Cliente</span></a>
    <a href="consultar_cliente.html"><i class="fas fa-search"></i><span>Consultar Cliente</span></a>
    <a href="#" id="relatoriosLink" onclick="toggleSubmenu('relatoriosSubcategoriesSidebar')">
        <i class="fas fa-chart-line"></i><span>Relatórios</span>
        <i class="fas fa-chevron-down" id="homeChevron" style="margin-left: 5px; transition: transform 0.3s;"></i>
    </a>
    <div id="relatoriosSubcategoriesSidebar" class="subcategory-sidebar">
        <a class="subcategory" href="#" onclick="toggleSubmenu('comercialSubcategoriesSidebar'); return false;">
            <i class="fas fa-briefcase"></i><span>Comercial</span>
            <i class="fas fa-chevron-down" style="margin-left: 5px; transition: transform 0.3s;"></i>
        </a>
        <div id="comercialSubcategoriesSidebar" class="subcategory-sidebar" style="display: none; padding-left: 20px;">
            <a href="relatorio_vendas_mensal.html" class="subcategory">
                <i class="fas fa-shopping-cart"></i><span>Vendas</span>
            </a>
            <a href="relatorio_vendas_anual.html" class="subcategory">
                <i class="fas fa-money-bill-wave"></i><span>Comissão à pagar</span>
            </a>
            <a href="relatorio_vendas_anual.html" class="subcategory">
                <i class="fas fa-hand-holding-usd"></i><span>Comissão à receber</span>
            </a>
            <a href="relatorio_vendas_anual.html" class="subcategory">
                <i class="fas fa-undo"></i><span>Estorno</span>
            </a>
        </div>
    </div>
    <a href="gerenciamento_leads.html"><i class="fas fa-users"></i><span>CRM de Leads</span></a>
    <a href="gerenciamento_visitas.html"><i class="fas fa-calendar-check"></i><span>CRM de Visitas</span></a>
    <a href="cadastro_usuario.html"><i class="fas fa-user-cog"></i><span>Cadastrar Usuário</span></a>
    <a href="configuracoes.html"><i class="fas fa-cogs"></i><span>Configurações</span></a>
    <div class="sidebar-bottom-buttons">
        <a href="gerenciar_dados.html" class="sidebar-button"><i class="fas fa-user-cog"></i><span>Perfil</span></a>
        <a href="#" id="sidebarLogoutButton" class="sidebar-button"><i class="fas fa-sign-out-alt"></i><span>Logout</span></a>
    </div>
</div>
    <div class="main-content" id="mainContent">
        <div class="header">
            <h1>C.R.M - Sistema de Gerenciamento de LEAD's</h1>
            <div class="header-buttons">
                
            </div>
        </div>
        <div class="action-container">
            <button class="toggle-button" onclick="toggleSection('form-container')">Adicionar Lead</button>
            <div class="filters-container">
                <div class="search-container">
                    <input type="text" id="searchInput1" placeholder="Digite para buscar..." onkeyup="filterLeads()">
                    <i class="fas fa-search search-icon"></i>
                </div>
                <div class="search-container">
                    <input type="text" id="searchInput2" placeholder="Digite para buscar..." onkeyup="filterLeads()">
                    <i class="fas fa-search search-icon"></i>
                </div>
            </div>
        </div>
        <div class="form-container-overlay" id="form-container-overlay" style="display: none;">
            <div class="form-container" id="form-container" style="position: relative;">
                <button class="close-button" onclick="toggleSection('form-container')">&times;</button>
                <h2>Adicionar Lead</h2>
                <form id="leadForm" style="display: flex; flex-direction: column; gap: 10px;">
                    <input type="text" id="nome" placeholder="Nome" required>
                    <input type="email" id="email" placeholder="Email" required>
                    <input type="text" id="telefone" placeholder="Telefone" required>
                    <select id="produto" name="produto" required>
                        <option value="" disabled selected>Produto</option>
                        <option value="AUTOMÓVEL">AUTOMÓVEL</option>
                        <option value="IMÓVEL">IMÓVEL</option>
                        <option value="SERVIÇO">SERVIÇO</option>
                        <option value="ELETRO">ELETRO</option>
                    </select>
                    <input type="text" id="valorNegociacao" placeholder="Valor da Negociação:" required>
                    <button type="submit">Adicionar Lead</button>
                </form>
            </div>
        </div>
        <div class="funnels">
            <div class="funnel-titles">
                <div class="funnel-stage">
                    <h2>Sem Contato</h2>
                    <p id="sem_contato_count">Leads: 0</p>
                    <p id="sem_contato_value">Valor Total: R$ 0,00</p>
                </div>
                <div class="funnel-stage">
                    <h2>Tentativa de Contato</h2>
                    <p id="tentativa_contato_count">Leads: 0</p>
                    <p id="tentativa_contato_value">Valor Total: R$ 0,00</p>
                </div>
                <div class="funnel-stage">
                    <h2>Contato Feito</h2>
                    <p id="contato_feito_count">Leads: 0</p>
                    <p id="contato_feito_value">Valor Total: R$ 0,00</p>
                </div>
                <div class="funnel-stage">
                    <h2>Em Negociação</h2>
                    <p id="em_negociacao_count">Leads: 0</p>
                    <p id="em_negociacao_value">Valor Total: R$ 0,00</p>
                </div>
                <div class="funnel-stage">
                    <h2>Proposta Enviada</h2>
                    <p id="proposta_enviada_count">Leads: 0</p>
                    <p id="proposta_enviada_value">Valor Total: R$ 0,00</p>
                </div>
                <div class="funnel-stage">
                    <h2>Fechado Falta Pagar</h2>
                    <p id="fechado_falta_pagar_count">Leads: 0</p>
                    <p id="fechado_falta_pagar_value">Valor Total: R$ 0,00</p>
                </div>
                <div class="funnel-stage">
                    <h2>Vendido</h2>
                    <p id="vendido_count">Leads: 0</p>
                    <p id="vendido_value">Valor Total: R$ 0,00</p>
                </div>
                <div class="funnel-stage">
                    <h2>Negociação Futura</h2>
                    <p id="negociacao_futura_count">Leads: 0</p>
                    <p id="negociacao_futura_value">Valor Total: R$ 0,00</p>
                </div>
                <div class="funnel-stage">
                    <h2>Perdidas/Relad</h2>
                    <p id="perdidas_relad_count">Leads: 0</p>
                    <p id="perdidas_relad_value">Valor Total: R$ 0,00</p>
                </div>
                <div class="funnel-stage">
                    <h2>Cancelados</h2>
                    <p id="cancelados_count">Leads: 0</p>
                    <p id="cancelados_value">Valor Total: R$ 0,00</p>
                </div>
            </div>
            <div class="funnel-leads">
                <div class="funnel-stage" data-stage="sem_contato">
                    <div class="dropzone lead-container"></div>
                </div>
                <div class="funnel-stage" data-stage="tentativa_contato">
                    <div class="dropzone lead-container"></div>
                </div>
                <div class="funnel-stage" data-stage="contato_feito">
                    <div class="dropzone lead-container"></div>
                </div>
                <div class="funnel-stage" data-stage="em_negociacao">
                    <div class="dropzone lead-container"></div>
                </div>
                <div class="funnel-stage" data-stage="proposta_enviada">
                    <div class="dropzone lead-container"></div>
                </div>
                <div class="funnel-stage" data-stage="fechado_falta_pagar">
                    <div class="dropzone lead-container"></div>
                </div>
                <div class="funnel-stage" data-stage="vendido">
                    <div class="dropzone lead-container"></div>
                </div>
                <div class="funnel-stage" data-stage="negociacao_futura">
                    <div class="dropzone lead-container"></div>
                </div>
                <div class="funnel-stage" data-stage="perdidas_relad">
                    <div class="dropzone lead-container"></div>
                </div>
                <div class="funnel-stage" data-stage="cancelados">
                    <div class="dropzone lead-container"></div>
                </div>
            </div>
        </div>
    </div>
    <div id="leadModal" class="modal" style="display: none;" onclick="fecharModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="close-button" onclick="fecharModal()">&times;</span>
            <div class="modal-header">
                <h2 id="modalLeadName">Nome do Lead</h2>
                <p id="modalLeadTelefone">Telefone: (00) 00000-0000</p>
            </div>
            <div class="modal-body">
                <!-- Card para Detalhes do Lead e Atualização da Etapa -->
                <div class="card">
                    <h3>Detalhes do Lead</h3>
                    <label for="modalLeadEmail">Email:</label>
                    <input type="email" id="modalLeadEmail">
                
                    <label for="modalLeadResponsavel">Responsável:</label>
                    <input type="text" id="modalLeadResponsavel">
                
                    <label for="modalLeadValor">Valor da Negociação:</label>
                    <input type="text" id="modalLeadValor">
                
                    <label for="modalLeadProduto">Produto:</label>
                    <select id="modalLeadProduto">
                        <option value="" disabled selected>Selecione</option>
                        <option value="AUTOMÓVEL">AUTOMÓVEL</option>
                        <option value="IMÓVEL">IMÓVEL</option>
                        <option value="SERVIÇO">SERVIÇO</option>
                        <option value="ELETRO">ELETRO</option>
                    </select>
                
                    <label for="modalLeadOrigem">Origem do Lead:</label>
                    <input type="text" id="modalLeadOrigem">
                
                    <label for="modalLeadStage"><strong>Etapa do Funil:</strong></label>
                    <select id="modalLeadStage">
                        <option value="sem_contato">Sem Contato</option>
                        <option value="tentativa_contato">Tentativa de Contato</option>
                        <option value="contato_feito">Contato Feito</option>
                        <option value="em_negociacao">Em Negociação</option>
                        <option value="proposta_enviada">Proposta Enviada</option>
                        <option value="fechado_falta_pagar">Fechado Falta Pagar</option>
                        <option value="vendido">Vendido</option>
                        <option value="negociacao_futura">Negociação Futura</option>
                        <option value="perdidas_relad">Perdidas/Relad</option>
                        <option value="cancelados">Cancelados</option>
                    </select>
                
                    <!-- Botão para salvar alterações -->
                    <button id="updateLeadStageButton" style="display: none;"></button>
                    <button id="saveLeadChangesButton" onclick="salvarAlteracoesLead()">Salvar Alterações</button>
                </div>
    
                <!-- Card para Gerenciar Tarefas -->
                <div class="card">
                    <h3>Gerenciar Tarefas</h3>
                    <form id="tarefaForm" onsubmit="adicionarTarefa(event)">
                        <label for="tarefa">Descrição:</label>
                        <input type="text" id="tarefa" placeholder="Descrição da tarefa" required>
                        
                        <label for="dataTarefa">Data:</label>
                        <input type="date" id="dataTarefa" required>
                        
                        <label for="horaTarefa">Hora:</label>
                        <input type="time" id="horaTarefa" required>
                        
                        <label for="tipoTarefa">Tipo:</label>
                        <select id="tipoTarefa" required>
                            <option value="ligacao">Ligação</option>
                            <option value="reuniao">Reunião</option>
                            <option value="email">E-mail</option>
                        </select>
                        
                        <button type="submit">Adicionar Tarefa</button>
                    </form>
                    <div id="tarefasContainer" class="tarefas-list">
                        <!-- Tarefas serão carregadas dinamicamente aqui -->
                    </div>
                </div>
                <!-- Card para Anotações -->
                <div class="card">
                    <h3>Anotações</h3>
                    <form id="anotacaoForm" onsubmit="adicionarAnotacao(event)">
                        <label for="anotacao">Escreva sua anotação:</label>
                        <textarea id="anotacao" placeholder="Digite sua anotação aqui..." rows="4" required></textarea>
                        <button type="submit">Adicionar Anotação</button>
                    </form>
                    <div id="anotacoesContainer" class="anotacoes-list">
                        <!-- Anotações serão carregadas dinamicamente aqui -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section.style.display === 'none') {
                section.style.display = 'block';
            } else {
                section.style.display = 'none';
            }
        }
    </script>
</body>
    <!-- Adicione os scripts do Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <!-- Adicione o script do SortableJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
    <script>
        // Configuração do Firebase
const firebaseConfig = {
  apiKey: "AIzaSyAKPIufxUNS2kHSErxCLANWev4w06-RfwY",
  authDomain: "cotafacil-b0489.firebaseapp.com",
  projectId: "cotafacil-b0489",
  storageBucket: "cotafacil-b0489.firebasestorage.app",
  messagingSenderId: "201488478427",
  appId: "1:201488478427:web:a334256656ec8fa53d5cfe",
  measurementId: "G-9BDP1YLJLE"
};
    
        // Inicializar o Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
    
        document.addEventListener('DOMContentLoaded', () => {
                        auth.onAuthStateChanged((user) => {
                if (user) {
                    // Carregar dados do usuário
                    db.collection('users').doc(user.email).get().then((doc) => {
                        if (doc.exists) {
                            const userData = doc.data();
                            
                            // Atualiza o nome do usuário, se o elemento existir
                            const userNameElement = document.getElementById('userName');
                            if (userNameElement) {
                                userNameElement.textContent = userData.name;
                            }
            
                            const role = userData.role;
                            if (role === 'proprietario-socio' || role === 'gestor-comercial') {
                                // Mostrar todos os leads
                                carregarLeads();
                            } else if (role === 'vendedor-interno' || role === 'vendedor-externo') {
                                // Mostrar apenas os leads do usuário
                                carregarLeads(user.email);
                            } else {
                                console.log("Usuário não autorizado.");
                            }
                        } else {
                            console.log("Nenhum dado encontrado!");
                        }
                    }).catch((error) => {
                        console.log("Erro ao obter documento:", error);
                    });
                }
            });
        
            document.getElementById('leadForm').addEventListener('submit', function(event) {
                event.preventDefault();
        
                const nome = document.getElementById('nome').value;
                const email = document.getElementById('email').value;
                const telefone = document.getElementById('telefone').value;
                const produto = document.getElementById('produto').value;
                const valorNegociacao = parseFloat(document.getElementById('valorNegociacao').value) || 0;
        
                adicionarLead(nome, email, telefone, produto, valorNegociacao);
                this.reset();
            });
        });
    
        function carregarLeads(emailVendedor = null) {
            let leadsQuery = db.collection('leads');
            if (emailVendedor) {
                leadsQuery = leadsQuery.where('vendedorEmail', '==', emailVendedor);
            }
        
            leadsQuery.get().then((querySnapshot) => {
                const stages = document.querySelectorAll('.lead-container');
                stages.forEach(stage => stage.innerHTML = ''); // Limpar leads anteriores
        
                const stageCounts = {};
                const stageValues = {};
        
                querySnapshot.forEach((doc) => {
                    const lead = doc.data();
                    lead.id = doc.id;
                    adicionarLeadAoDOM(lead);
        
                    // Contar leads e somar valores
                    if (!stageCounts[lead.stage]) {
                        stageCounts[lead.stage] = 0;
                        stageValues[lead.stage] = 0;
                    }
                    stageCounts[lead.stage]++;
                    stageValues[lead.stage] += parseFloat(lead.valorNegociacao) || 0;
                });
        
                // Atualizar contagens e valores nos títulos dos funis
                for (const stage in stageCounts) {
                    const countElement = document.getElementById(`${stage}_count`);
                    const valueElement = document.getElementById(`${stage}_value`);
                    if (countElement) {
                        countElement.textContent = `Leads: ${stageCounts[stage]}`;
                    }
                    if (valueElement) {
                        valueElement.textContent = `Valor Total: ${formatarValorBRL(stageValues[stage])}`;
                    }
                }
        
                // Inicializar SortableJS para cada etapa do funil
                stages.forEach(stage => {
                    new Sortable(stage, {
                        group: 'leads',
                        animation: 150,
                        onEnd: function (evt) {
                            // Atualizar a etapa do lead no Firebase
                            const leadId = evt.item.dataset.id;
                            const newStage = evt.to.closest('.funnel-stage').dataset.stage;
                            db.collection('leads').doc(leadId).update({
                                stage: newStage
                            }).then(() => {
                                console.log('Lead atualizado com sucesso!');
                                carregarLeads(emailVendedor); // Recarregar leads para atualizar contagens e valores
                            }).catch((error) => {
                                console.error('Erro ao atualizar lead:', error);
                            });
                        }
                    });
                });
            }).catch((error) => {
                console.error("Erro ao carregar leads: ", error);
            });
        }
    
        function adicionarLead(nome, email, telefone, produto, valorNegociacao) {
            const user = firebase.auth().currentUser;
        
            if (!user) {
                console.error('Usuário não autenticado.');
                alert('Erro: Usuário não autenticado.');
                return;
            }
        
            // Obter o nome do usuário autenticado
            db.collection('users').doc(user.email).get().then((doc) => {
                if (doc.exists) {
                    const userName = doc.data().name || doc.data().nome || 'Desconhecido';
        
                    // Criar o objeto do lead com o nome do responsável
                    const lead = {
                        nome,
                        email,
                        telefone,
                        produto,
                        valorNegociacao: parseFloat(valorNegociacao) || 0,
                        pontuacao: calcularPontuacao(),
                        stage: 'sem_contato', // Etapa inicial
                        vendedorEmail: user.email, // Email do vendedor
                        vendedorNome: userName, // Nome do responsável
                        proximaTarefa: null // Inicialmente sem tarefa agendada
                    };
        
                    // Salvar o lead no banco de dados
                    db.collection('leads').add(lead).then((docRef) => {
                        lead.id = docRef.id;
                        adicionarLeadAoDOM(lead);
                        carregarLeads(user.email); // Recarregar leads para atualizar contagens e valores
                    }).catch((error) => {
                        console.error('Erro ao adicionar lead:', error);
                    });
                } else {
                    console.error('Dados do usuário não encontrados.');
                    alert('Erro: Dados do usuário não encontrados.');
                }
            }).catch((error) => {
                console.error('Erro ao obter dados do usuário:', error);
                alert('Erro ao obter dados do usuário.');
            });
        }
            
        function adicionarLeadAoDOM(lead) {
            const stageElement = document.querySelector(`[data-stage="${lead.stage}"] .lead-container`);
            if (!stageElement) {
                console.error(`Elemento de estágio não encontrado para o estágio: ${lead.stage}`);
                return;
            }
        
            const leadCard = document.createElement('div');
            leadCard.className = 'lead-card';
            leadCard.dataset.id = lead.id;
        
            // Obter o nome do responsável pelo lead
            db.collection('users').doc(lead.vendedorEmail).get().then((doc) => {
                const vendedorNome = doc.exists ? doc.data().name || doc.data().nome : 'Desconhecido';
                const valorNegociacao = lead.valorNegociacao ? formatarValorBRL(parseFloat(lead.valorNegociacao)) : 'R$ 0,00';
                const produto = lead.produto || '--';
                const origemLead = lead.origemLead || '--';
        
                leadCard.innerHTML = `
                    <div class="lead-header">
                        <h3 class="lead-name">${lead.nome}</h3>
                        <div class="lead-score">${lead.pontuacao}</div>
                    </div>
                    <div class="lead-details">
                        <p><span class="lead-email">Email:</span> ${lead.email}</p>
                        <p><span class="lead-telefone">Telefone:</span> ${lead.telefone}</p>
                        <p><span class="lead-responsavel">Responsável:</span> ${vendedorNome}</p>
                        <p><span class="lead-valor-negociacao">Valor da Negociação:</span> ${valorNegociacao}</p>
                        <p><span class="lead-produto">Produto de Interesse:</span> ${produto}</p>
                        <p><span class="lead-origem">Origem do Lead:</span> ${origemLead}</p>
                        <p class="next-task-date">Próxima Tarefa: Carregando...</p>
                    </div>
                `;
        
                // Adicionar evento de clique para abrir o modal
                leadCard.addEventListener('click', () => {
                    abrirModal(lead, vendedorNome, valorNegociacao, produto, origemLead);
                });
        
                // Verificar se há tarefas não concluídas
                db.collection('leads').doc(lead.id).collection('tarefas')
                    .where('concluida', '==', false)
                    .orderBy('dataHora', 'asc')
                    .get()
                    .then((querySnapshot) => {
                        if (!querySnapshot.empty) {
                            const tarefa = querySnapshot.docs[0].data();
                            const nextTaskDate = tarefa.dataHora.toDate();
                            const nextTaskDateWithoutTime = new Date(nextTaskDate.getFullYear(), nextTaskDate.getMonth(), nextTaskDate.getDate() + 1); // Considera o dia seguinte
                
                            leadCard.querySelector('.next-task-date').textContent = `Próxima Tarefa: ${nextTaskDate.toLocaleDateString()}`;
                
                            // Destacar o card em vermelho se a tarefa estiver atrasada (após o dia seguinte)
                            if (new Date() >= nextTaskDateWithoutTime) {
                                leadCard.classList.add('red');
                                stageElement.prepend(leadCard); // Move o card vermelho para o topo
                            } else {
                                stageElement.appendChild(leadCard); // Adiciona o card normalmente
                            }
                        } else {
                            leadCard.querySelector('.next-task-date').textContent = 'Nenhuma tarefa agendada';
                
                            // Não destacar em vermelho para etapas específicas
                            const noRedStages = ['sem_contato', 'tentativa_contato', 'vendido', 'perdidas_relad', 'cancelados'];
                            if (!noRedStages.includes(lead.stage)) {
                                const isRedStage = !noRedStages.includes(lead.stage);
                                if (isRedStage) {
                                    leadCard.classList.add('red');
                                    stageElement.prepend(leadCard); // Move o card vermelho para o topo
                                } else {
                                    stageElement.appendChild(leadCard); // Adiciona o card normalmente
                                }
                            } else {
                                stageElement.appendChild(leadCard); // Adiciona o card normalmente
                            }
                        }
                    }).catch((error) => {
                        console.error('Erro ao verificar tarefas:', error);
                        leadCard.querySelector('.next-task-date').textContent = 'Erro ao carregar tarefas';
                        stageElement.appendChild(leadCard); // Adiciona o card normalmente em caso de erro
                    });
        
            }).catch((error) => {
                console.error('Erro ao obter nome do responsável:', error);
            });
        }
        
        function abrirModal(lead, vendedorNome, valorNegociacao, produto, origemLead) {
            document.getElementById('modalLeadName').textContent = lead.nome;
            document.getElementById('modalLeadTelefone').textContent = `Telefone: ${lead.telefone}`;
            document.getElementById('modalLeadEmail').value = lead.email || 'Não informado';
            document.getElementById('modalLeadResponsavel').value = vendedorNome || 'Não informado';
            document.getElementById('modalLeadValor').value = valorNegociacao || 'R$ 0,00';
        
            const produtoSelect = document.getElementById('modalLeadProduto');
            produtoSelect.value = produto || "";
        
            document.getElementById('modalLeadOrigem').value = origemLead || 'Não informado';
        
            const stageSelect = document.getElementById('modalLeadStage');
            stageSelect.value = lead.stage || 'sem_contato';
        
            const updateButton = document.getElementById('updateLeadStageButton');
            if (updateButton) {
                updateButton.dataset.leadId = lead.id;
            } else {
                console.error('Botão de atualização não encontrado no DOM.');
            }
        
            carregarTarefas(lead.id); // Carregar tarefas
            carregarAnotacoes(lead.id); // Carregar anotações
        
            const modal = document.getElementById('leadModal');
            modal.style.display = 'block';
        }

        function carregarTarefas(leadId) {
            db.collection('leads').doc(leadId).collection('tarefas').orderBy('dataHora', 'asc').get().then((querySnapshot) => {
                const tarefasContainer = document.getElementById('tarefasContainer');
                tarefasContainer.innerHTML = ''; // Limpar tarefas anteriores
        
                querySnapshot.forEach((doc) => {
                    const tarefa = doc.data();
                    const tarefaElement = document.createElement('div');
                    tarefaElement.classList.add('note');
                    tarefaElement.innerHTML = `
                        <p><strong>Descrição:</strong> ${tarefa.descricao}</p>
                        <p><strong>Data e Hora:</strong> ${new Date(tarefa.dataHora.toDate()).toLocaleString()}</p>
                        <p><strong>Tipo:</strong> ${tarefa.tipo}</p>
                        <p><strong>Concluída:</strong> ${tarefa.concluida ? 'Sim' : 'Não'}</p>
                        <button class="btn-submit" onclick="marcarComoConcluida('${leadId}', '${doc.id}')">Marcar como Concluída</button>
                        <button class="btn-submit" onclick="editarTarefa('${leadId}', '${doc.id}', '${tarefa.descricao}', '${tarefa.dataHora.toDate().toISOString().split('T')[0]}', '${tarefa.dataHora.toDate().toISOString().split('T')[1].substring(0, 5)}', '${tarefa.tipo}')">Editar</button>
                    `;
                    tarefasContainer.appendChild(tarefaElement);
                });
            }).catch((error) => {
                console.error("Erro ao carregar tarefas:", error);
            });
        }

        function marcarComoConcluida(leadId, tarefaId) {
            // Atualizar o status da tarefa para "concluída"
            db.collection('leads').doc(leadId).collection('tarefas').doc(tarefaId).update({
                concluida: true
            }).then(() => {
                console.log('Tarefa marcada como concluída com sucesso!');
                alert('Tarefa marcada como concluída!');
                carregarTarefas(leadId); // Recarregar a lista de tarefas para refletir a alteração
            }).catch((error) => {
                console.error('Erro ao marcar tarefa como concluída:', error);
                alert('Erro ao marcar tarefa como concluída. Tente novamente.');
            });
        }

        function atualizarEtapaDoLead() {
            const leadId = document.getElementById('updateLeadStageButton').dataset.leadId;
            const newStage = document.getElementById('modalLeadStage').value;
        
            db.collection('leads').doc(leadId).update({
                stage: newStage
            }).then(() => {
                console.log('Etapa do lead atualizada com sucesso!');
                fecharModal();
                carregarLeads(); // Recarregar os leads para refletir a mudança
            }).catch((error) => {
                console.error('Erro ao atualizar a etapa do lead:', error);
            });
        }
        
        function fecharModal(event) {
            const modal = document.getElementById('leadModal');
            if (!event || event.target === modal) {
                modal.style.display = 'none';
            }
        }
    
        function calcularPontuacao() {
            // Implementar lógica de cálculo de pontuação
            return Math.floor(Math.random() * 100) + 1; // Exemplo: pontuação aleatória entre 1 e 100
        }
        function formatarValorBRL(valor) {
            return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }
        function filterLeads() {
            const searchInput1 = document.getElementById('searchInput1').value.toLowerCase();
            const searchInput2 = document.getElementById('searchInput2').value.toLowerCase();
            const leadCards = document.querySelectorAll('.lead-card');
        
            // Objeto para armazenar contagens e valores por estágio
            const stageCounts = {};
            const stageValues = {};
        
            leadCards.forEach(card => {
                const leadName = card.querySelector('.lead-name').textContent.toLowerCase();
                const leadEmail = card.querySelector('.lead-email').nextSibling.textContent.toLowerCase().trim();
                const leadTelefone = card.querySelector('.lead-telefone').nextSibling.textContent.toLowerCase().trim();
                const leadResponsavel = card.querySelector('.lead-responsavel').nextSibling.textContent.toLowerCase().trim();
                const leadProduto = card.querySelector('.lead-produto').nextSibling.textContent.toLowerCase().trim();
                const leadOrigem = card.querySelector('.lead-origem').nextSibling.textContent.toLowerCase().trim();
                const leadValorNegociacao = card.querySelector('.lead-valor-negociacao').nextSibling.textContent.toLowerCase().trim();
                const leadStage = card.closest('.funnel-stage').dataset.stage;
        
                // Verifica se o lead atende a qualquer um dos dois filtros
                if (
                    (leadName.includes(searchInput1) || leadEmail.includes(searchInput1) || leadTelefone.includes(searchInput1) ||
                    leadResponsavel.includes(searchInput1) || leadProduto.includes(searchInput1) || leadOrigem.includes(searchInput1) ||
                    leadValorNegociacao.includes(searchInput1)) &&
                    (leadName.includes(searchInput2) || leadEmail.includes(searchInput2) || leadTelefone.includes(searchInput2) ||
                    leadResponsavel.includes(searchInput2) || leadProduto.includes(searchInput2) || leadOrigem.includes(searchInput2) ||
                    leadValorNegociacao.includes(searchInput2))
                ) {
                    card.style.display = 'block';
        
                    // Atualiza contagens e valores por estágio
                    if (!stageCounts[leadStage]) {
                        stageCounts[leadStage] = 0;
                        stageValues[leadStage] = 0;
                    }
                    stageCounts[leadStage]++;
                    stageValues[leadStage] += parseFloat(leadValorNegociacao.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0;
                } else {
                    card.style.display = 'none';
                }
            });
        
            // Atualiza os valores e contagens nos títulos dos funis
            for (const stage in stageCounts) {
                const countElement = document.getElementById(`${stage}_count`);
                const valueElement = document.getElementById(`${stage}_value`);
                if (countElement) {
                    countElement.textContent = `Leads: ${stageCounts[stage]}`;
                }
                if (valueElement) {
                    valueElement.textContent = `Valor Total: ${formatarValorBRL(stageValues[stage])}`;
                }
            }
        
            // Zera os valores e contagens para estágios sem leads visíveis
            const allStages = document.querySelectorAll('.funnel-stage');
            allStages.forEach(stage => {
                const stageId = stage.dataset.stage;
                if (!stageCounts[stageId]) {
                    const countElement = document.getElementById(`${stageId}_count`);
                    const valueElement = document.getElementById(`${stageId}_value`);
                    if (countElement) {
                        countElement.textContent = `Leads: 0`;
                    }
                    if (valueElement) {
                        valueElement.textContent = `Valor Total: R$ 0,00`;
                    }
                }
            });
        }

        function atualizarCampoLead(campo, valor) {
            const leadId = document.getElementById('updateLeadStageButton').dataset.leadId;
        
            // Formatar o valor se for o campo de valor de negociação
            if (campo === 'valorNegociacao') {
                valor = parseFloat(valor.replace('R$', '').replace(/\./g, '').replace(',', '.')) || 0;
            }
        
            // Atualizar o campo no banco de dados
            const updateData = {};
            updateData[campo] = valor;
        
            db.collection('leads').doc(leadId).update(updateData)
                .then(() => {
                    console.log(`Campo ${campo} atualizado com sucesso!`);
                })
                .catch((error) => {
                    console.error(`Erro ao atualizar o campo ${campo}:`, error);
                });
        }
        function salvarAlteracoesLead() {
            const updateButton = document.getElementById('updateLeadStageButton');
            if (!updateButton) {
                console.error('Botão de atualização não encontrado no DOM.');
                return;
            }
        
            const leadId = updateButton.dataset.leadId;
        
            if (!leadId) {
                console.error('ID do lead não encontrado.');
                return;
            }
        
            // Obter os valores dos campos
            const email = document.getElementById('modalLeadEmail').value;
            const responsavel = document.getElementById('modalLeadResponsavel').value;
            const valorNegociacao = parseFloat(document.getElementById('modalLeadValor').value.replace('R$', '').replace(/\./g, '').replace(',', '.')) || 0;
            const produto = document.getElementById('modalLeadProduto').value; // Obter o valor selecionado
            const origemLead = document.getElementById('modalLeadOrigem').value;
            const stage = document.getElementById('modalLeadStage').value;
        
            // Criar objeto com os dados atualizados
            const updateData = {
                email,
                responsavel,
                valorNegociacao,
                produto,
                origemLead,
                stage
            };
        
            // Atualizar o lead no banco de dados
            db.collection('leads').doc(leadId).update(updateData)
                .then(() => {
                    console.log('Alterações salvas com sucesso!');
                    alert('Alterações salvas com sucesso!');
                    // Não recarregar os leads nem fechar o modal
                })
                .catch((error) => {
                    console.error('Erro ao salvar alterações do lead:', error);
                    alert('Erro ao salvar alterações. Tente novamente.');
                });
        }
        function adicionarTarefa(event) {
            event.preventDefault(); // Evita o recarregamento da página ao enviar o formulário
        
            // Obter o ID do lead a partir do botão oculto no modal
            const leadId = document.getElementById('updateLeadStageButton').dataset.leadId;
        
            if (!leadId) {
                console.error('ID do lead não encontrado.');
                alert('Erro: ID do lead não encontrado.');
                return;
            }
        
            // Obter os valores dos campos do formulário
            const descricao = document.getElementById('tarefa').value;
            const data = document.getElementById('dataTarefa').value;
            const hora = document.getElementById('horaTarefa').value;
            const tipo = document.getElementById('tipoTarefa').value;
        
            if (!descricao || !data || !hora || !tipo) {
                alert('Por favor, preencha todos os campos da tarefa.');
                return;
            }
        
            const dataHora = new Date(`${data}T${hora}`);
        
            // Obter o usuário autenticado
            const user = firebase.auth().currentUser;
        
            if (!user) {
                console.error('Usuário não autenticado.');
                alert('Erro: Usuário não autenticado.');
                return;
            }
        
            // Verificar se já existe uma tarefa para o mesmo dia e horário
            db.collection('leads').doc(leadId).collection('tarefas')
                .where('dataHora', '==', dataHora)
                .where('usuario', '==', user.email)
                .get()
                .then((querySnapshot) => {
                    if (!querySnapshot.empty) {
                        alert('Você já tem uma tarefa agendada para este dia e horário.');
                    } else {
                        // Criar o objeto da tarefa
                        const tarefa = {
                            descricao,
                            dataHora,
                            tipo,
                            concluida: false,
                            usuario: user.email
                        };
        
                        // Adicionar a tarefa ao banco de dados
                        db.collection('leads').doc(leadId).collection('tarefas').add(tarefa)
                            .then(() => {
                                console.log('Tarefa adicionada com sucesso!');
                                alert('Tarefa adicionada com sucesso!');
                                carregarTarefas(leadId); // Recarregar a lista de tarefas
                                document.getElementById('tarefaForm').reset(); // Limpar o formulário
                            })
                            .catch((error) => {
                                console.error('Erro ao adicionar tarefa:', error);
                                alert('Erro ao adicionar tarefa. Tente novamente.');
                            });
                    }
                })
                .catch((error) => {
                    console.error('Erro ao verificar tarefas:', error);
                    alert('Erro ao verificar tarefas. Tente novamente.');
                });
        }
        function adicionarAnotacao(event) {
            event.preventDefault(); // Evita o recarregamento da página ao enviar o formulário
        
            // Obter o ID do lead a partir do botão oculto no modal
            const leadId = document.getElementById('updateLeadStageButton').dataset.leadId;
        
            if (!leadId) {
                console.error('ID do lead não encontrado.');
                alert('Erro: ID do lead não encontrado.');
                return;
            }
        
            // Obter o valor da anotação
            const anotacao = document.getElementById('anotacao').value;
        
            if (!anotacao) {
                alert('Por favor, escreva uma anotação.');
                return;
            }
        
            // Obter o usuário autenticado
            const user = firebase.auth().currentUser;
        
            if (!user) {
                console.error('Usuário não autenticado.');
                alert('Erro: Usuário não autenticado.');
                return;
            }
        
            // Criar o objeto da anotação
            const novaAnotacao = {
                texto: anotacao,
                dataHora: new Date(),
                usuario: user.email
            };
        
            // Adicionar a anotação ao banco de dados
            db.collection('leads').doc(leadId).collection('anotacoes').add(novaAnotacao)
                .then(() => {
                    console.log('Anotação adicionada com sucesso!');
                    alert('Anotação adicionada com sucesso!');
                    carregarAnotacoes(leadId); // Recarregar a lista de anotações
                    document.getElementById('anotacaoForm').reset(); // Limpar o formulário
                })
                .catch((error) => {
                    console.error('Erro ao adicionar anotação:', error);
                    alert('Erro ao adicionar anotação. Tente novamente.');
                });
        }
        function carregarAnotacoes(leadId) {
            db.collection('leads').doc(leadId).collection('anotacoes').orderBy('dataHora', 'asc').get()
                .then((querySnapshot) => {
                    const anotacoesContainer = document.getElementById('anotacoesContainer');
                    anotacoesContainer.innerHTML = ''; // Limpar anotações anteriores
        
                    querySnapshot.forEach((doc) => {
                        const anotacao = doc.data();
                        const anotacaoElement = document.createElement('div');
                        anotacaoElement.classList.add('note');
                        anotacaoElement.innerHTML = `
                            <p>${anotacao.texto}</p>
                            <p><small><strong>Data:</strong> ${new Date(anotacao.dataHora.toDate()).toLocaleString()}</small></p>
                            <p><small><strong>Usuário:</strong> ${anotacao.usuario}</small></p>
                        `;
                        anotacoesContainer.appendChild(anotacaoElement);
                    });
                })
                .catch((error) => {
                    console.error('Erro ao carregar anotações:', error);
                });
        }
</script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
    const sidebarLogoutButton = document.getElementById('sidebarLogoutButton');
    if (sidebarLogoutButton) {
        sidebarLogoutButton.addEventListener('click', () => {
            auth.signOut().then(() => {
                window.location.href = 'login.html'; // Redirecionar para a página de login após logout
            }).catch((error) => {
                console.error('Erro ao fazer logout:', error);
            });
        });
    } else {
        console.error("Elemento com ID 'sidebarLogoutButton' não encontrado.");
    }
});
function toggleSubmenu(submenuId) {
    const submenu = document.getElementById(submenuId);
    const chevron = submenu.previousElementSibling.querySelector('.fas.fa-chevron-down');

    if (submenu.style.display === "none" || submenu.style.display === "") {
        submenu.style.display = "block";
        chevron.style.transform = "rotate(-90deg)"; // Aponta para a direita
    } else {
        submenu.style.display = "none";
        chevron.style.transform = "rotate(0deg)"; // Aponta para baixo
    }
}
document.addEventListener('DOMContentLoaded', () => {
    const sidebar = document.getElementById('sidebar');
    const relatoriosLink = document.getElementById('relatoriosLink');

    if (sidebar && relatoriosLink) {
        sidebar.addEventListener('mouseleave', () => {
            // Simula o clique no botão "Relatórios"
            relatoriosLink.click();
        });
    } else {
        console.error("Elemento 'sidebar' ou 'relatoriosLink' não encontrado.");
    }
});
function toggleSubmenu(submenuId) {
    const submenu = document.getElementById(submenuId);
    const allSubmenus = document.querySelectorAll('.subcategory-sidebar'); // Seleciona todos os submenus
    const chevron = submenu.previousElementSibling.querySelector('.fas.fa-chevron-down');

    // Fecha outros submenus abertos
    allSubmenus.forEach(otherSubmenu => {
        if (otherSubmenu !== submenu && otherSubmenu.style.display === 'block') {
            otherSubmenu.style.display = 'none';
            const otherChevron = otherSubmenu.previousElementSibling.querySelector('.fas.fa-chevron-down');
            if (otherChevron) {
                otherChevron.style.transform = 'rotate(0deg)'; // Reseta o ícone do submenu fechado
            }
        }
    });

    // Alterna o submenu atual
    if (submenu.style.display === 'none' || submenu.style.display === '') {
        submenu.style.display = 'block';
        if (chevron) {
            chevron.style.transform = 'rotate(-90deg)'; // Aponta para a direita
        }
    } else {
        submenu.style.display = 'none';
        if (chevron) {
            chevron.style.transform = 'rotate(0deg)'; // Aponta para baixo
        }
    }
}
document.addEventListener('DOMContentLoaded', () => {
    const sidebar = document.getElementById('sidebar');
    const relatoriosSubmenu = document.getElementById('relatoriosSubcategoriesSidebar');
    const relatoriosChevron = document.getElementById('homeChevron');

    if (sidebar && relatoriosSubmenu) {
        sidebar.addEventListener('mouseleave', () => {
            if (relatoriosSubmenu.style.display === 'block') {
                relatoriosSubmenu.style.display = 'none';
                if (relatoriosChevron) {
                    relatoriosChevron.style.transform = 'rotate(0deg)'; // Reseta o ícone
                }
            }
        });

        sidebar.addEventListener('mouseenter', () => {
            // Não reabre automaticamente o submenu ao retornar
            if (relatoriosSubmenu.style.display === 'block') {
                relatoriosSubmenu.style.display = 'none';
                if (relatoriosChevron) {
                    relatoriosChevron.style.transform = 'rotate(0deg)'; // Reseta o ícone
                }
            }
        });
    } else {
        console.error("Elemento 'sidebar' ou 'relatoriosSubcategoriesSidebar' não encontrado.");
    }
});
function toggleSubmenu(submenuId) {
    const submenu = document.getElementById(submenuId);
    const homeSubmenu = document.getElementById('homeSubcategoriesSidebar');
    const relatoriosSubmenu = document.getElementById('relatoriosSubcategoriesSidebar');
    const chevron = submenu.previousElementSibling.querySelector('.fas.fa-chevron-down');

    // Fecha o submenu "Home" se o submenu "Relatórios" for clicado
    if (submenuId === 'relatoriosSubcategoriesSidebar' && homeSubmenu.style.display === 'block') {
        homeSubmenu.style.display = 'none';
        const homeChevron = document.getElementById('homeChevron');
        if (homeChevron) {
            homeChevron.style.transform = 'rotate(0deg)'; // Reseta o ícone do submenu fechado
        }
    }

    // Fecha o submenu "Relatórios" se o submenu "Home" for clicado
    if (submenuId === 'homeSubcategoriesSidebar' && relatoriosSubmenu.style.display === 'block') {
        relatoriosSubmenu.style.display = 'none';
        const relatoriosChevron = relatoriosSubmenu.previousElementSibling.querySelector('.fas.fa-chevron-down');
        if (relatoriosChevron) {
            relatoriosChevron.style.transform = 'rotate(0deg)'; // Reseta o ícone do submenu fechado
        }
    }

    // Alterna o submenu atual
    if (submenu.style.display === 'none' || submenu.style.display === '') {
        submenu.style.display = 'block';
        if (chevron) {
            chevron.style.transform = 'rotate(-90deg)'; // Aponta para a direita
        }
    } else {
        submenu.style.display = 'none';
        if (chevron) {
            chevron.style.transform = 'rotate(0deg)'; // Aponta para baixo
        }
    }
}
document.addEventListener('DOMContentLoaded', () => {
    const sidebar = document.getElementById('sidebar');
    const homeSubmenu = document.getElementById('homeSubcategoriesSidebar');
    const relatoriosSubmenu = document.getElementById('relatoriosSubcategoriesSidebar');
    const comercialSubmenu = document.getElementById('comercialSubcategoriesSidebar');
    const homeChevron = document.getElementById('homeChevron');
    const relatoriosChevron = relatoriosSubmenu?.previousElementSibling.querySelector('.fas.fa-chevron-down');
    const comercialChevron = comercialSubmenu?.previousElementSibling.querySelector('.fas.fa-chevron-down');

    if (sidebar) {
        sidebar.addEventListener('mouseleave', () => {
            // Fecha o submenu "Home" se estiver aberto
            if (homeSubmenu && homeSubmenu.style.display === 'block') {
                homeSubmenu.style.display = 'none';
                if (homeChevron) {
                    homeChevron.style.transform = 'rotate(0deg)'; // Reseta o ícone
                }
            }

            // Fecha o submenu "Relatórios" se estiver aberto
            if (relatoriosSubmenu && relatoriosSubmenu.style.display === 'block') {
                relatoriosSubmenu.style.display = 'none';
                if (relatoriosChevron) {
                    relatoriosChevron.style.transform = 'rotate(0deg)'; // Reseta o ícone
                }
            }

            // Fecha o submenu "Comercial" se estiver aberto
            if (comercialSubmenu && comercialSubmenu.style.display === 'block') {
                comercialSubmenu.style.display = 'none';
                if (comercialChevron) {
                    comercialChevron.style.transform = 'rotate(0deg)'; // Reseta o ícone
                }
            }
        });
    } else {
        console.error("Elemento 'sidebar' não encontrado.");
    }
});
function toggleSection(sectionId) {
    const overlay = document.getElementById('form-container-overlay');
    const section = document.getElementById(sectionId);

    if (overlay.style.display === 'none' || overlay.style.display === '') {
        overlay.style.display = 'flex'; // Exibe o modal
    } else {
        overlay.style.display = 'none'; // Oculta o modal
    }
}

function ajustarAlturaLeadContainer() {
            const leadContainers = document.querySelectorAll('.lead-container');
            const headerHeight = document.querySelector('.header').offsetHeight || 0; // Altura do cabeçalho
            const funnelTitlesHeight = document.querySelector('.funnel-titles').offsetHeight || 0; // Altura dos títulos dos funis
            const marginBottom = 200; // Margem de segurança no final
            const availableHeight = window.innerHeight - headerHeight - funnelTitlesHeight - marginBottom; // Altura disponível com margem
        
            leadContainers.forEach(container => {
                container.style.height = `${availableHeight}px`;
            });
        }
        
        // Chamar a função ao carregar a página e ao redimensionar a janela
        window.addEventListener('load', ajustarAlturaLeadContainer);
        window.addEventListener('resize', ajustarAlturaLeadContainer);
</script>
</body>
</html>